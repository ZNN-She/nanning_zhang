(function(e){function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)})([function(e,t,n){"use strict";function g(e,t){var n=e.pageX,r=e.pageY,i=t;while(i!==document.body)n-=i.offsetLeft,r-=i.offsetTop,i=i.offsetParent;return{x:n,y:r}}function y(e){if(d.target)return;var t=e.changedTouches[0],n=g(t,this.canvas),r=n.x,i=n.y,o=this.hitTest(new u.default(r,i)),a=new s.default(s.default.TOUCHSTART);a.attr({bubble:!0,x:r,y:i,target:o.target}),o.target.dispatchEvent(a),d.target=o.target,d.moved=!1,d.timeout=!1,clearTimeout(v),v=setTimeout(function(){d.timeout=!0},500)}function b(e){if(!d.target)return;var t=e.changedTouches[0];d.moved=!0;if(!this.noTouchMove){e.preventDefault();var n=new s.default(s.default.TOUCHMOVE),r=g(t,this.canvas),i=r.x,o=r.y;n.attr({bubble:!0,x:i,y:o,target:d.target}),d.target.dispatchEvent(n)}}function w(e){if(!d.target)return;e.preventDefault();var t=e.changedTouches[0],n=g(t,this.canvas),r=n.x,i=n.y;clearTimeout(v),v=null;var o=new s.default(s.default.TOUCHEND);o.attr({bubble:!0,x:r,y:i,target:d.target}),d.target.dispatchEvent(o);if(!d.moved&&!d.timeout){var u=new s.default(s.default.TAP);u.attr({bubble:!0,x:r,y:i,target:d.target}),d.target.dispatchEvent(u)}d.target=null,d.moved=!1,d.timeout=!1}function E(e){var t=g(e,this.canvas),n=t.x,r=t.y,i=this.hitTest(new u.default(n,r)),o=new s.default(s.default.CLICK);o.attr({bubble:!0,x:n,y:r,target:i.target}),i.target.dispatchEvent(o)}function x(e){var t=this;clearTimeout(S),S=setTimeout(function(){var e="";t.initOption.width?e+="width:"+t.initOption.width+"px;":e+="width:0;",t.initOption.height?e+="height:"+t.initOption.height+"px;":e+="height:0;",t.canvas.style.cssText=e;var n=t.canvas.parentNode;t.resize({width:n.clientWidth,height:n.clientHeight})},200)}function T(e){var t=g(e,this.canvas),n=t.x,r=t.y,i=this.hitTest(new u.default(n,r)),s=m;if(m&&i.target!==m){var a=new o.default(o.default.MOUSELEAVE);a.attr({target:m}),m.dispatchEvent(a),m=null}if(i.target!==this&&i.target!==s){var f=new o.default(o.default.MOUSEENTER);f.attr({target:i.target}),i.target.dispatchEvent(f),m=i.target}}var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(1),s=n(2),o=n(3),u=n(4),a=n(5),f=n(6),l=n(8),c=n(12),h=n(14),p=document.documentElement,d={target:null,moved:!1,timeout:!1},v,m,S,N=function(e){function t(t){t===void 0&&(t={}),e.call(this,t),this.keyReg=/x|y|name|alpha|visible|pointerEvents|parent|stage|extraRender|extraHitTest|transform|width|height|ratioX|ratioY/;var n=this.canvas,r=t.global_scale||2,i=parseFloat(t.width)||p.clientWidth,s=parseFloat(t.height)||p.clientHeight;this.noResize=t.noResize||!1,this.noTouchMove=t.noTouchMove||!1,this.width=i,this.height=s,this.ratioX=r,this.ratioY=r,n.style.cssText+="width:"+i+"px;height:"+s+"px;",n.setAttribute("width",i*r),n.setAttribute("height",s*r),n.addEventListener("touchstart",y.bind(this)),n.addEventListener("touchmove",b.bind(this)),n.addEventListener("touchend",w.bind(this)),n.addEventListener("touchcancel",w.bind(this)),n.addEventListener("click",E.bind(this)),n.addEventListener("mousemove",T.bind(this)),this.noResize||window.addEventListener("resize",x.bind(this))}return r(t,e),t.prototype.resize=function(e){e===void 0&&(e={width:0,height:0});var t=this.initOption.width||e.width||p.clientWidth,n=this.initOption.height||e.height||p.clientHeight,r=this.canvas;this.width=t,this.height=n,r.style.cssText+="width:"+t+"px;height:"+n+"px;",r.setAttribute("width",t*this.ratioX),r.setAttribute("height",n*this.ratioY);for(var s=0,o=this.numChildren;s<o;s++)this.children[s].dispatchEvent(i.default.RESIZE);return this.dispatchEvent(i.default.RESIZE),this.repaint=!0,this},t.prototype.destroy=function(){var t=this.canvas;return t.removeEventListener("touchstart",y.bind(this)),t.removeEventListener("touchmove",b.bind(this)),t.removeEventListener("touchend",w.bind(this)),t.removeEventListener("touchcancel",w.bind(this)),t.removeEventListener("click",E.bind(this)),t.removeEventListener("mousemove",T.bind(this)),window.removeEventListener("resize",x.bind(this)),e.prototype.remove.call(this),this},t.geom={Point:u.default,Rectangle:a.default},t.event={Event:i.default,TouchEvent:s.default},t.display={Sprite:l.default,Image:h.default,TextContent:c.default},t}(f.default);window.CanvasRender=N,Object.defineProperty(t,"__esModule",{value:!0}),t.default=N},function(e,t){"use strict";var n=function(){function e(e,t){e===void 0&&(e=""),t===void 0&&(t=!1),this.keyReg=/type|bubble|target/,this._type=e,this._bubble=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubble",{get:function(){return this._bubble},set:function(e){this._bubble=e},enumerable:!0,configurable:!0}),e.prototype.stopPaganation=function(){this.bubble=!1},e.prototype.attr=function(e,t){t===void 0&&(t=null);if(typeof e=="object")for(var n in e)e.hasOwnProperty(n)&&this.keyReg.test(n)&&(this[n]=e[n]);else if(typeof e=="string"){if(!t||!this.keyReg.test(e))return this.keyReg.test(e)?this[e]:null;this[e]=t}return this},e.ENTER_FRAME="enter_frame",e.ADDED_TO_STAGE="added_to_stage",e.TOUCHSTART="touchstart",e.TOUCHMOVE="touchmove",e.TOUCHEND="touchend",e.TAP="tap",e.CLICK="click",e.LOAD="load",e.ERROR="error",e.RESIZE="resize",e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(1),s=function(e){function t(t,n){t===void 0&&(t=""),n===void 0&&(n=!1),e.call(this,t,n),this.keyReg=/type|bubble|target|x|y|pageX|pageY/}return r(t,e),t.TOUCHSTART="touchstart",t.TOUCHMOVE="touchmove",t.TOUCHEND="touchend",t.TAP="tap",t.CLICK="click",t}(i.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(1),s=function(e){function t(t,n){t===void 0&&(t=""),n===void 0&&(n=!1),e.call(this,t,n),this.keyReg=/type|bubble|target|x|y|pageX|pageY/}return r(t,e),t.MOUSEDOWN="mousedown",t.MOUSEMOVE="mousemove",t.MOUSEUP="mouseup",t.MOUSEENTER="mouseenter",t.MOUSELEAVE="mouseleave",t.CLICK="click",t}(i.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s},function(e,t){"use strict";var n=function(){function e(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return e.prototype.hitTest=function(e){return this.x>=e.x&&this.x<=e.x+e.width&&this.y>=e.y&&this.y<=e.y+e.height},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";var n=function(){function e(e,t,n,r){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=e,this.y=t,this.width=n,this.height=r}return e.prototype.hitTest=function(t){if(t instanceof e){var n=t;return!(n.x>this.x+this.width||n.x+n.width<this.x||n.y>this.y+this.height||n.y+n.height<this.y)}return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(7),s=n(8),o=function(e){function t(t){e.call(this,t),this.keyReg=/x|y|name|alpha|visible|pointerEvents|parent|stage|extraRender|extraHitTest|transform|width|height|ratioX|ratioY|canvas|ctx|repaint/;var n=t.canvas;if(!n||!n.nodeType||n.nodeType!==1||!n.tagName||n.tagName!=="CANVAS")throw"\u8bf7\u4f20\u5165canvas\u5bf9\u8c61\uff01";this._canvas=n;var r=n.getContext("2d");this._ctx=r,this.stage=this,this.width=t.width||0,this.height=t.height||0,this.ratioX=t.ratioX||1,this.ratioY=t.ratioY||1,this._repaint=!0;var s=+(new Date),o=0,u=0,a=this;this.paintFn=t.debug?function(){var e=a._repaint,t=+(new Date);a.paint();if(e){var n=Math.floor(1e3/(t-s));o+=n,u++;var i=Math.round(o/u);r.fillStyle="#000",r.font="24px \u5fae\u8f6f\u96c5\u9ed1",r.fillText("FPS : "+Math.floor(1e3/(t-s))+" / "+i,10,30)}s=t}:function(){a.paint()},i.default.listen(this.paintFn,null)}return r(t,e),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ctx",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),t.prototype.prepareRender=function(e,t,n){var r=this.ctx;if(!r)return;r.save(),r.scale(this.ratioX,this.ratioY);for(var i=0,s=this.numChildren;i<s;i++)this.children[i].prepareRender(e+this.x,t+this.y,n*this.alpha);r.restore()},t.prototype.hitTest=function(t,n,r){var i=e.prototype.hitTest.call(this,t,n,r);return i.target!==null?i:{target:this}},t.prototype.paint=function(){if(this._repaint){var e=this.canvas;this._repaint=!1,this.ctx.clearRect(0,0,e.getAttribute("width"),e.getAttribute("height")),this.prepareRender(0,0,1)}},t.prototype.remove=function(){return this.destroyEvent(),this.removeChildren(),i.default.unlisten(this.paintFn,null),this},t}(s.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},function(e,t){"use strict";function l(){for(var e=u.length;e--;){var t=u[e];t.destroy?u.splice(e,1):t.fn.apply(t.tgt)}for(var n=a.length;n--;){var r=a.splice(n,1)[0];r.fn.apply(r.tgt)}!u.length&&!a.length&&h()}function c(e){i?r=n(function t(){e(),f?f=!1:r=n(t)}):r=setInterval(e,o)}function h(){i?f=!0:clearInterval(r),r=0}var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,r=null,i=!!n,s=Math.round(1e3/60),o=s,u=[],a=[],f=!1,p={listen:function(e,t){if(typeof e=="string")try{e=(new Function("return "+e))()}catch(n){}return typeof e=="function"&&(t=t||window,u.unshift({fn:e,tgt:t})),r||c(l),p},raf:function(e,t){if(typeof e=="string")try{e=(new Function("return "+e))()}catch(n){}return typeof e=="function"&&(t=t||window,a.unshift({fn:e,tgt:t})),r||c(l),p},unlisten:function(e,t){if(typeof e=="function"||typeof e=="string"){t=t||window;for(var n=u.length;n--;)if(u[n].fn===e||u[n].fn.toString().replace(/\s/g,"")===e.toString().replace(/\s/g,"")&&u[n].tgt===t){u[n].destroy=1;break}}return p},setFPS:function(e,t){if(typeof e=="number"){var r=Math.round(1e3/e);if(r!==o){o=r;var u=void 0;o>s||t?u=!1:(o=s,u=!!n),h(),i=u,c(l)}}return p}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=p},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(9),s=n(1),o=n(2),u=n(10),a=n(5),f=n(6),l=n(11),c=function(e){function t(t){t===void 0&&(t={}),e.call(this),this.keyReg=/x|y|name|alpha|visible|pointerEvents|parent|stage|extraRender|extraHitTest|transform/,this._children=[],this.name=t.name||"",this.x=t.x||0,this.y=t.y||0,this._alpha=t.alpha===+t.alpha?t.alpha:1,this.visible=t.visible===!!t.visible?t.visible:!0,this.pointerEvents=t.pointerEvents===!!t.pointerEvents?t.pointerEvents:!0,this._extraRender=t.extraRender||null,this._extraHitTest=t.extraHitTest||null,this.initOption=t,t.transform&&this.setTransform(t.transform),this.addEventListener(s.default.ADDED_TO_STAGE,this.addedToStage)}return r(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repaint",{set:function(e){this.stage&&(this.stage._repaint=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depth",{get:function(){if(this.parent===null)return 0;for(var e=this.parent.numChildren;e--;)if(this.parent.children[e]===this)return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=Math.min(Math.max(e,0),1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraRender",{get:function(){return this._extraRender},set:function(e){if(e===null||typeof e=="function")this._extraRender=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraHitTest",{get:function(){return this._extraHitTest},set:function(e){if(e===null||typeof e=="function")this._extraHitTest=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),t.prototype.attr=function(e,t){t===void 0&&(t=null);if(typeof e=="object")for(var n in e)this.attr(n,e[n]);else if(typeof e=="string"){if(!t||!this.keyReg.test(e))return this.keyReg.test(e)?this[e]:null;e==="transform"?this.setTransform(t):this[e]=t}return this},t.prototype.setTransform=function(e){var t=/matrix\((.+?)\)/.exec(e);if(t)this._transform=t[1].split(/\s*,\s*/).map(function(e){return parseFloat(e)});else{var n=/translate\((.+?)\)/.exec(e),r=/scale\((.+?)\)/.exec(e),i=/rotate\((.+?)\)/.exec(e),s=new l.default;if(n){var o=n[1].split(/\s*,\s*/);s.translate(parseFloat(o[0]),parseFloat(o[1]))}if(r){var u=r[1].split(/\s*,\s*/);u[1]?s.scale(parseFloat(u[0]),parseFloat(u[1])):s.scale(parseFloat(u[0]))}if(i){var a=i[1];a.indexOf("deg")>0?s.rotate(parseFloat(a)*Math.PI/180):s.rotate(parseFloat(a))}this._transform=s.toString().split(",").map(function(e){return parseFloat(e)})}return this},t.prototype.addedToStage=function(e){var t=this.numChildren,n=this.children,r=this.stage;if(t&&r)for(var i=0;i<t;i++)n[i].stage=r},t.prototype.prepareRender=function(e,t,n){var r=this.stage;if(!r||!this.visible)return;e+=this.x,t+=this.y,n*=this.alpha;if(n<=0)return;var i=r.ctx;i.save(),i.globalAlpha=n,i.translate(e,t),this.render(),this.extraRender&&this.extraRender(),i.restore();for(var s=0,o=this.numChildren;s<o;s++){var u=this.children[s];u.parent!==this&&(u.parent=this),u.prepareRender(e,t,n)}},t.prototype.render=function(){},t.prototype.hitTest=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=0);if(!this.stage||!this.visible||!this.pointerEvents)return{target:null};t+=this.x,n+=this.y;for(var r=this.numChildren;r--;){var i=this.children[r].hitTest(e,t,n);if(i.target!==null)return i}if(this.extraHitTest){var s=this.extraHitTest(e,t,n);if(s&&s.target!==null)return s}return{target:null}},t.prototype.getHitTestArea=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0);var n=0,r=0;e+=this.x,t+=this.y;for(var i=this.numChildren;i--;){var s=this.children[i].getHitTestArea(e,t);e=Math.min(e,s.x),t=Math.min(t,s.y),n=Math.max(n,s.width+s.x-e),r=Math.max(r,s.height+s.y-t)}return new a.default(e,t,n,r)},t.prototype.appendChild=function(){var e=[];for(var n=0;n<arguments.length;n++)e[n-0]=arguments[n];var r=this.numChildren;for(var i=0,s=e.length;i<s;i++){var o=e[i];o instanceof t&&this.appendChildAt(e[i],r++)}return this},t.prototype.appendChildAt=function(e,t){if(!(e instanceof f.default)&&!isNaN(t)){e.parent&&e.parent.removeChild(e);var n=this.numChildren;t=Math.max(0,Math.min(t,n)),e.parent=this,this.children.splice(t,0,e),e.stage!==this.stage&&(e.stage=this.stage),this.repaint=!0}return this},t.prototype.remove=function(){this.destroyEvent(),this.stage=null;var e=this.parent;return e&&(e.removeChild(this),this.parent=null),this.removeChildren(),this},t.prototype.removeChild=function(e){var t=this.children;for(var n=this.numChildren;n--;)if(t[n]===e){t.splice(n,1),e.parent=null,e.stage=null;break}return this},t.prototype.removeChildAt=function(e){if(!isNaN(e)&&e>=0&&e<this.numChildren){var t=this.children.splice(e,1)[0];t.parent=null,t.stage=null}return this},t.prototype.removeChildren=function(){var e=this.children;for(var t=this.numChildren;t--;){var n=e.splice(t,1)[0];n.parent=null,n.stage=null}return this},t.prototype.getChildIndex=function(e){if(!!e&&e instanceof t&&e.parent===this){for(var n=this.numChildren;n--;)if(this.children[n]===e)return n;return-1}return-1},t.prototype.setChildIndex=function(e,n){if(!!e&&e instanceof t&&e.parent===this){var r=this.getChildIndex(e),i=this.children;return n=Math.max(0,Math.min(n,this.numChildren)),r===n?this:(i.splice(r,1),i.splice(n,0,e),this)}return this},t.prototype.includeBy=function(e){if(e instanceof t){var n=this.parent;while(n){if(n===e)return!0;n=n.parent}}return!1},t.prototype.include=function(e){for(var t=0,n=this.numChildren;t<n;t++){var r=this.children[t];if(r===e||r.include(e))return!0}return!1},t.prototype.getChildAt=function(e){return!isNaN(e)&&e>=0&&e<this.numChildren?this.children[e]:null},t.prototype.getChildrenByName=function(e){var t=[],n="";/^([\^\$~])=(.+)/.test(e)&&(n=RegExp.$1,e=RegExp.$2);for(var r=this.numChildren;r--;){var i=this.children[r],s=i.name;if(n)switch(n){case"^":s.indexOf(e)===0&&t.push(i);break;case"$":var o=s.lastIndexOf(e);o!==-1&&o+e.length===s.length&&t.push(i);break;default:s.indexOf(e)!==-1&&t.push(i)}else s===e&&t.push(i)}return t},t.prototype.getChildrenByType=function(e){var t=[];for(var n=0,r=this.numChildren;n<r;n++){var i=this.children[n];i instanceof e&&t.push(i)}return t},t.prototype.enableDrag=function(e){e===void 0&&(e=null);var t=null,n=function(n){if(t&&this.stage){var r=t.x-t.touchX+n.x,i=t.y-t.touchY+n.y;if(e!==null){var s=e.x,o=e.y,u=e.width,a=e.height;r=Math.min(Math.max(r,s),s+u),i=Math.min(Math.max(r,o),o+a)}this.x=r,this.y=i,this.repaint=!0}},r=function(e){t=null,this.removeEventListener(o.default.TOUCHMOVE,n).removeEventListener(o.default.TOUCHEND,r)};return this.addEventListener("touchstart",function(e){t||(t={x:this.x,y:this.y,touchX:e.x,touchY:e.y},this.stage.addEventListener(o.default.TOUCHMOVE,n).addEventListener(o.default.TOUCHEND,r))}),this},t.prototype.disableDrag=function(){return this.removeEventListener("touchstart"),this},t.prototype.sprite=function(e){var n=new t(e);return this.appendChild(n),n},t.prototype.image=function(e){var t=new i.display.Image(e);return this.appendChild(t),t},t.prototype.textContent=function(e){var t=new i.display.TextContent(e);return this.appendChild(t),t},t}(u.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=c},function(e,t){"use strict";var n=function(){function e(e){}return e}(),r={Image:n,TextContent:n};t.display=r},function(e,t,n){"use strict";function i(e){return e.filter(function(e){return!!e})}function s(e,t){for(var n=e.length;n--;)if(t.indexOf(e[n])!==-1)return!0;return!1}var r=n(1),o=function(){function e(){this.evCache=[]}return e.prototype.addEventListener=function(e,t,n,r){n===void 0&&(n=!1),r===void 0&&(r=!1);var s=e.toLowerCase().split(".");if(s[0]&&t){var o=n?"unshift":"push";if(typeof t=="string")try{t=(new Function("return "+t))()}catch(u){}if(typeof t=="function"){var a=i(s.slice(1));this.evCache[o]({type:s[0],namespace:a,callback:t,locked:r})}}return this},e.prototype.on=function(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.addEventListener(e,t,n,r)},e.prototype.removeEventListener=function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=e.toLowerCase().split("."),o=i(r);if(r[0]||o.length)for(var u=this.evCache.length;u--;){var a=this.evCache[u];(!r[0]||r[0]===a.type)&&(!o.length||s(o,a.namespace))&&(!t&&!a.locked||t===a.callback&&n===a.locked)&&this.evCache.splice(u,1)}else for(var u=this.evCache.length;u--;){var a=this.evCache[u];a.locked||this.removeEventListener(a.type,a.callback)}return this},e.prototype.off=function(e,t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i;typeof e=="string"&&(i=new r.default(e),i.target=this),i=e;if(i instanceof r.default){t.unshift(i);var s=i.type;for(var o=0,u=this.evCache.length;o<u;o++){var a=this.evCache[o];if(s===a.type&&a.callback.apply(this,t)===!1)return this}if(i.bubble&&this.parent){var f=this.parent;f.dispatchEvent&&typeof f.dispatchEvent=="function"&&f.dispatchEvent.apply(f,t)}return this}return this},e.prototype.trigger=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.dispatchEvent.apply(this,e)},e.prototype.destroyEvent=function(){this.evCache.splice(0,this.evCache.length)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},function(e,t){"use strict";var n=function(){function e(e,t,n,r,i,s){e===void 0&&(e=1),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=1),i===void 0&&(i=0),s===void 0&&(s=0),this.m1=e,this.m2=t,this.m3=n,this.m4=r,this.m5=i,this.m6=s}return e.prototype.translate=function(t,n){return this.multiply(new e(1,0,0,1,t,n))},e.prototype.rotate=function(t){return this.multiply(new e(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0))},e.prototype.scale=function(t,n){return n===void 0&&(n=undefined),n===undefined&&(n=t),this.multiply(new e(t,0,0,n,0,0))},e.prototype.multiply=function(e){var t=this.m1*e.m1+this.m2*e.m3,n=this.m1*e.m2+this.m2*e.m4,r=this.m3*e.m1+this.m4*e.m3,i=this.m3*e.m2+this.m4*e.m4,s=this.m1*e.m5+this.m2*e.m6+this.m5,o=this.m3*e.m5+this.m4*e.m6+this.m6;return this.m1=t,this.m2=n,this.m3=r,this.m4=i,this.m5=s,this.m6=o,this},e.prototype.toString=function(){return this.m1+","+this.m2+","+this.m3+","+this.m4+","+this.m5+","+this.m6},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function f(e){var t=[],n=e.search(a);if(n>=0){t.push(e.substr(0,n));var r=RegExp.$1;t.push(r),t.push(e.substr(n+r.length))}else t.push(e);return t}var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(8),s=n(5),o=n(13),u=n(9),a=/(\n|[\x00-\xff]{2,}|[\u201c\u2018\u300a\uff5b\u3010\uff08{\(\[\x00-\xff]+[\u4e00-\u9fa5][\uff0c\u3002\u3001\u201d\u2019\u300b\uff5d\u3011\uff09}\]\)\uff1f\uff01\u2026\u2014\x00-\xff]*|[\u201c\u2018\u300a\uff5b\u3010\uff08{\(\[\x00-\xff]*[\u4e00-\u9fa5][\uff0c\u3002\u3001\u201d\u2019\u300b\uff5d\u3011\uff09}\]\)\uff1f\uff01\u2026\u2014\x00-\xff]+)/,l={color:"#000",fontFamily:"Microsoft Yahei",fontSize:"12px",fontStyle:"normal",fontWeight:"normal",lineHeight:"1.2",textAlign:"left",textOverflow:"",whiteSpace:""},c=function(e){function t(t){t===void 0&&(t={}),e.call(this,t),this.keyReg=/x|y|name|alpha|visible|pointerEvents|parent|stage|extraRender|extraHitTest|transform|text|width/,this._text="",this._width="auto",this.realWidth=0,this.realHeight=0,this._text=t.text||"",this._width=t.width||"auto",this._style=o.default({},l,t.style||{})}return r(t,e),t.prototype.style=function(e,t){if(typeof e=="string"){if(!t)return this._style[e];this._style[e]=t}else if(typeof e=="object")for(var n in e)this.style(n,e[n]);return""},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this.stage&&(this.formatText(),this.repaint=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){(typeof e=="number"||e==="auto")&&this._width!==e&&(this._width=e,typeof e=="number"&&(this.realWidth=e))},enumerable:!0,configurable:!0}),t.prototype.addedToStage=function(t){e.prototype.addedToStage.call(this,t),this.stage&&(this.formatText(),this.repaint=!0)},t.prototype.formatText=function(){var e=[[]],t=this,n=this.text,r=0,i=0,s="",o,u,a,l,c,h;if(!this.tmp_ctx){var p=document.createElement("canvas");this.tmp_ctx=p.getContext("2d")}this.tmp_ctx.font=this._style.fontStyle+" "+this._style.fontWeight+" "+this._style.fontSize+" "+this._style.fontFamily,o=this.tmp_ctx.measureText("\u4e00").width;var d=function(n){u=f(n);var p=t.realWidth;for(var v=0,m=u[0].length;v<m;v++){l=u[0].charCodeAt(v),a=u[0].charAt(v),c=l>255?o:this.tmp_ctx.measureText(a).width;if(i+c<=p||!i)s+=a,i+=c;else{s&&(h={text:s,width:this.tmp_ctx.measureText(s).width},e[r].push(h)),i=c;if(t._style.whiteSpace==="nowrap"){if(t._style.textOverflow==="ellipsis"){var g=h.text.substr(-1);g.charCodeAt(0)>255?h.text=h.text.substr(0,h.text.length-1):h.text=h.text.substr(0,h.text.length-2),h.text+="\u2026"}s="",u[1]=null;break}e[++r]=[],s=a}}if(u[1]){a=u[1],c=this.tmp_ctx.measureText(a).width;if(i+c<=p||!i)s+=a,i+=c;else{h={text:s,width:this.tmp_ctx.measureText(s).width},e[r].push(h);if(t._style.whiteSpace==="nowrap"){if(t._style.textOverflow==="ellipsis"){var g=h.text.substr(-1);g.charCodeAt(0)>255?h.text=h.text.substr(0,h.text.length-1):h.text=h.text.substr(0,h.text.length-2),h.text+="\u2026"}u[2]=null}else e[++r]=[],h={text:a,width:Math.ceil(c)},e[r].push(h);s="",i=c}u[2]&&d(u[2])}s&&(h={text:s,width:this.tmp_ctx.measureText(s).width},e[r].push(h),s="")};if(this.width==="auto"){var v=this.tmp_ctx.measureText(n).width;e[0].push({text:n,width:v}),this.realWidth=v}else d(this.text);return this.realHeight=Math.round(e.length*parseFloat(this._style.lineHeight)*parseFloat(this._style.fontSize)),this.textCache=e,this},t.prototype.hitTest=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=0),!this.stage||!this.visible||!this.pointerEvents?{target:null}:e.hitTest(this.getHitTestArea(t,n))?{target:this}:{target:null}},t.prototype.getHitTestArea=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=0),e+=this.x,t+=this.y,new s.default(e,t,this.realWidth,this.realHeight)},t.prototype.render=function(){e.prototype.render.call(this);var t=this.realWidth,n=0,r=parseFloat(this._style.lineHeight)*parseFloat(this._style.fontSize),i=this._style.textAlign;this.stage.ctx.textAlign=i,i==="center"?n+=Math.round(t/2):i==="right"&&(n+=t),this.stage.ctx.textBaseline="middle",this.stage.ctx.fillStyle=this._style.color,this.stage.ctx.font=this._style.fontStyle+" "+this._style.fontWeight+" "+this._style.fontSize+" "+this._style.fontFamily;var s=this.textCache,o=s&&s.length;if(o)for(var u=0;u<o;u++){var a=n,f=0;if(i==="center"){for(var l=0,c=this.textCache[u].length;l<c;l++)f+=this.textCache[u][l].width;a-=f/2}else if(i==="right"){for(var l=1,c=this.textCache[u].length;l<c;l++)f+=this.textCache[u][l].width;a-=f}for(var h=0,p=this.textCache[u].length;h<p;h++){var d=this.textCache[u][h];i==="right"&&h>0?a+=d.width:i==="center"&&(a+=Math.round(d.width/2)),this.stage.ctx.fillText(d.text,a,Math.round((u+.5)*r)),i!=="center"&&i!=="right"?a+=d.width:i==="center"&&(a+=Math.round(d.width/2))}}},t}(i.default);u.display.TextContent=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c},function(e,t){"use strict";function n(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t.length;r<i;r++)for(var s in t[r])e[s]=t[r][s];return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},i=n(1),s=n(8),o=n(5),u=n(9),a={},f=["left","right","center","start","end"],l=["top","bottom","center","start","end","middle"],c=function(e){function t(t){t===void 0&&(t={}),e.call(this,t),this.keyReg=/x|y|name|alpha|visible|pointerEvents|parent|stage|extraRender|extraHitTest|transform|src|source|width|height|clipX|clipY|clipWidth|clipHeight/,this.src=t.src||"",this._width=t.width||"auto",this._height=t.height||"auto",this.clipX=t.clipX||0,this.clipY=t.clipY||0,this.clipWidth=t.clipWidth||0,this.clipHeight=t.clipHeight||0,this.source=t.source||"",this.alignX=t.alignX||0,this.alignY=t.alignY||0}return r(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){(typeof e=="number"||e==="auto")&&this._width!==e&&(this._width=e,this.checkSize())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){(typeof e=="number"||e==="auto")&&this._height!==e&&(this._height=e,this.checkSize())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignX",{get:function(){return this._alignX},set:function(e){(typeof e=="number"||~f.indexOf(e))&&this._alignX!==e&&(this._alignX=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignY",{get:function(){return this._alignY},set:function(e){(typeof e=="number"||~l.indexOf(e))&&this._alignY!==e&&(this._alignY=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ctx",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),t.prototype.addedToStage=function(t){e.prototype.addedToStage.call(this,t),this.src&&this.loadImage()},t.prototype.loadImage=function(){var e=this.src;if(!e||!this.stage)return;if(!a[e]){var t=this;a[e]=new Image,a[e].crossOrigin="",a[e].onload=function(){if(!this.width||!this.height||!this.src)return;t.checkSize(),t.dispatchEvent(i.default.LOAD)},a[e].onerror=function(){t.dispatchEvent(i.default.ERROR),a[e]=null},a[e].src=e}else!a[e].width||!a[e].height?(this.dispatchEvent(i.default.ERROR),a[e]=null):(this.checkSize(),this.dispatchEvent(i.default.LOAD))},t.prototype.checkSize=function(){var e=this.source||a[this.src];e&&e.width&&e.height&&(this.width==="auto"||this.height==="auto"?this.height!=="auto"?(this.realHeight=this.height,this.realWidth=Math.round(this.realHeight*e.width/e.height)):this.width!=="auto"?(this.realWidth=this.width,this.realHeight=Math.round(this.realWidth*e.height/e.width)):(this.realWidth=e.width,this.realHeight=e.height):(this.realWidth=this.width,this.realHeight=this.height),this.repaint=!0)},t.prototype.hitTest=function(e,t,n){if(!this.stage||!this.visible||!this.pointerEvents)return{target:null};if(this.extraHitTest){var r=this.extraHitTest(e,t,n);if(r&&r.target!==null)return r}else if(e.hitTest(this.getHitTestArea(t,n)))return{target:this};return{target:null}},t.prototype.getHitTestArea=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0);var n,r;return e+=this.x,t+=this.y,this.clipWidth&&this.clipHeight?(r=this.clipWidth,n=this.clipHeight):(r=this.realWidth,n=this.realHeight),new o.default(e,t,r,n)},t.prototype.render=function(){e.prototype.render.call(this);var t=this.src,n;if(this.source)n=this.source;else{if(!t)return;if(!a[t]){this.loadImage();return}n=a[t]}(!this.realWidth||!this.realHeight)&&this.checkSize();var r=this.stage.ctx,i=this.clipWidth,s=this.clipHeight,o=0,u=0;if(i&&s){this.transform&&(r.translate(i/2,s/2),r.transform.apply(r,this.transform),r.translate(-i/2,-s/2));if(typeof this.alignX=="number")o=this.alignX;else switch(this.alignX){case"right":case"end":o=-this.clipX;break;case"center":o=-this.clipX/2}if(typeof this.alignY=="number")u=this.alignY;else switch(this.alignY){case"bottom":case"end":u=-this.clipY;break;case"center":case"middle":u=-this.clipY/2}r.drawImage(n,this.clipX,this.clipY,i,s,o,u,this.realWidth,this.realHeight)}else{this.transform&&(r.translate(this.realWidth/2,this.realHeight/2),r.transform.apply(r,this.transform),r.translate(-this.realWidth/2,-this.realHeight/2));if(typeof this.alignX=="number")o=this.alignX;else switch(this.alignX){case"right":case"end":o=-this.realWidth;break;case"center":o=-this.realWidth/2}if(typeof this.alignY=="number")u=this.alignY;else switch(this.alignY){case"bottom":case"end":u=-this.realHeight;break;case"center":case"middle":u=-this.realHeight/2}r.drawImage(n,o,u,this.realWidth,this.realHeight)}},t}(s.default);u.display.Image=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c}]);